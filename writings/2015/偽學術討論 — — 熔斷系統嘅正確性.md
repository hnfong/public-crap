# 偽學術討論 — — 熔斷系統嘅正確性

話說中國股市熔斷乜乜乜，間接影響本大爺身家性命財產，唯有漏夜睇下發生咩事。睇完一輪外國勢力評論，結論都係唔知乜春咁好「爆」⋯

早前有朋友話大陸證券市場毫無常理可言，信焉。我總覺得大家用成熟嘅歐美證券市場去看待中國市場，所以中國市場相比之下先咁奇怪。大家忘記咗當年歐美市場都試過亂到七彩摸著石頭過河。

你可以話中證監冇理由連基本嘅外國經驗都冇參考過，但現實就係中國證券市場唔開放俾外國人，而國內嘅炒家基本上全部都係乜撚都唔識嘅（暴發）散戶。就算管理金融嘅機構行事理性，中國人嘅市場照舊用返中國邏輯，最後都係炒大鑊。

我鳩估啦，而家中國金融體制嗰班話事人面對緊兩難局面。一嚟佢哋想繼續開放市場；但市場越開放，就越變得難以預測。然後一旦遇上一班乜X都唔識嘅散戶，一般經濟理論假設嘅「理性行為」就唔成立，然後亂七八糟，最後又要被迫入市調整，個市場又要被管制，無限輪迴。

某程度上，咁係應驗咗成龍兩個金句：「中國的會爆炸」、「中國人需要管的」。其實成龍大哥份人幾老實，係風流咗少少咁啫，唔知點解大家咁撚憎佢 :0)

有啲嘢未試過切膚之痛係唔會真正得到教訓嘅。個市場唔係每十年八載冧一次，啲人係唔會知道原來炒股會燶嘅 :0)

至於呢幾日被譽為萬惡之首嘅熔斷機制，啲人係咁插佢「本質上」有問題，但其實同類制度喺外國行咗好多年，如果要插呢個機制本身，咁難道世界各地嘅證券制度都咁柒？（嗱可能係架，不過出事之後先馬後炮個個都識啦。）如果話中證監個制度有問題，就係熔斷嘅上下限定得好細，7% 全面停市係細得太離譜。

－－－以下係系統學嘅技術討論，不喜勿看－－－

其實「熔斷機制」本質上係一種「靠簡陋資訊判斷情況是否有異」嘅機制，必然會有錯判嘅情況。而任何錯判之後作出嘅「修正」，幾乎係 by definition 係會一錯再錯，好容易陷入一個 positive feedback loop （唔好俾 “positive” 誤導，呢度係解越嚟越衰，越衰越快，可以譯作「惡性盾環」）。

利申我唔係做金融嘅，我做（電腦）系統嘅。「靠簡陋資訊判斷情況是否有異」嘅機制，喺網絡程式／網絡系統好常見。話說網絡上嘅系統，因為時時都有可能斷線，所以你 send 咗個 message 俾對方，對方未答你「收到喇」之前，個 message 有可能係傳送中遺失，或者可能對方咁啱 down 咗收唔到，之類。所以如果等一段時間之後，對方都唔應機，咁就要再 send 過。

聽落好正常啦係咪？但係其實，咁樣做同「熔斷機制」一樣，可以好危險架。如果對方真係咁啱收唔到，重新 send 過當然冇問題。但「對方唔應機」仲有乜嘢可能性？就係佢太忙，根本應唔切！試想像下你係一部好忙嘅 server，應唔切啲 message，然後對方以為你收唔到，又再 send 多個 message 過嚟，咁咪仲衰！所以啲「忙忙哋」嘅系統好易忽然陷入一個惡性循環然後暴斃。

出事之後，啲叻唔切嘅人就可能會話「邊個設計啲咁白痴嘅嘢架哈哈哈，傻嘅都知咁樣會出事架啦」，但事實上有限度嘅 “timeout + retry” 功能係網絡系統必須嘅嘢嚟，如果冇咗佢，世界係會停頓架 （真）。個問題只不過係個 “timeout” 設定係幾耐，同埋試幾多次。其中一個令到呢件事冇咁差嘅方法，就係每次等耐啲先重試，幾何級 (exponential) 咁上。例如第一次等 1 秒，第二次 2 秒，之後 4 秒、 8 秒咁上 [1]。加多少少隨機因素就最好。試到咁上下就要放棄架啦，咁就唯有當對方真係「死咗」應唔到你。

不過最搞笑嘅係，就算網絡程式 （例如瀏覽器）放棄咗，用家（i.e. 人）就未必會放棄嘅。以前都聽過有啲網站因為本身「忙忙哋」所以好慢，或者淨係 load 到一半，所以啲人不停撳 F5，然後呢啲額外嘅 F5 流量最後拖死啲 server。好好玩架。所以一部 server 如果平時嘅最高用量超過佢容量嘅一半，就開始要留心架喇，因為衰起上嚟好易忽然墮入惡性循環然後忽然死咗。Murphy’s Law 與你常在。

講返股市。熔斷機制喺現代嘅股票市場其實可能比以前更加重要。近十幾年近興嘅所謂 high frequency trading (HFT)，同埋其他各類 automated trading systems 都可以喺 bug 咗嘅情況下令到個市場大起大落。2010 年 5 月 10 日忽然無端端冧市 [2] （然後無端端反彈），有幾隻大公司股價跌至近乎零。最後呢件事點解發生冇一個普遍接受嘅解釋，不過其中一個講法就係由 HFT 導致。另外比較近期嘅例子有 Knight Capital 嗰單，一個 bug 搞到幾分鐘之內股市大亂，Knight Capital 自己一日之內唔見咗四億幾美元，搞到間公司幾乎摺埋。

你可能會想知道有冇咩方法避免呢啲「bug」？個方法就係「熔斷」囉。不過今次中國股市嘅「熔斷」係講緊成個股市而唔係幾單買賣咁解啫。

至於點解中證監個熔斷機制一開始設定得咁柒，唔聰明少少，我就唔知喇。不過呢啲「靠簡陋資訊判斷情況是否有異」嘅問題，其實點整都死，最多只可以話將個 limit 調較得比較寬鬆。咁你可能問，邊個話一定要靠「簡陋資訊」唧？點解唔可以不斷收集各種資訊然後判斷個市有冇異常？

理論上冇話唔得 [4]，如果個「聰明熔斷系統」識得睇股價以外嘅資訊，冇話唔得架。不過你諗下，如果你知道咩係「異常股價」，咁即係知道咩係「正常股價」啦？如果你好肯定知道「正常」股價嘅上下限，咁你直接高買低賣，發咗達啦，仲使乜幫阿公設計熔斷系統？係咪咁話？ 而就算有人肯幫你設計一個「聰明熔斷系統」，你信唔信佢？最後佢嘅可信度咪同某某分析員話呢隻股票目標價幾多一樣囉。你可以將個 error margin 拉闊啲，例如 +/- 10% 咁，夠未？ 係得架，咁咪即係現時嘅「笨柒熔斷機制」囉。話晒 efficient market hypothesis 乜乜乜嘛，之前嗰日嘅股價理應準確反映當時嘅市場價值架喎，爭一日，唔差好遠架咋。

所以講到尾都係冇得搞，用最低能嘅方法，拉大個上下限，最叻都唯有做到咁架咋。或者唔搞熔斷都得嘅，不過就有上述嘅其他風險囉。買大買細，任君選擇。

— — — — -

利申：我唔識金融財經。

- [1]: https://en.wikipedia.org/wiki/Exponential_backoff
- [2]: https://en.wikipedia.org/wiki/2010_Flash_Crash
- [3]: 仲有呢單都好出名 http://www.reuters.com/article/us-usa-nyse-tradinghalts-idUSBRE8701BN20120801 http://www.bloomberg.com/bw/articles/2012-08-02/knight-shows-how-to-lose-440-million-in-30-minutes
- [4]: 反正係我講，咁順便講埋，Gödel 乜乜乜 （好似係），你就算可以證明你個 program 冇 bug，都唔可以證明你個證明冇 bug…….. 如此類推……

（原文於 2016 年 1 月發佈，略有修輯）
