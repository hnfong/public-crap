<!DOCTYPE html><html><head><title>Poker</title><style>body{font-family:sans-serif;margin:0}#d{display:flex;flex-direction:column;align-items:center}#b{margin:10px 0}button{margin:5px 0}</style></head><body><div id="d"><div id="b"></div><div id="h"></div><div id="p"></div></div><button id="n">New Hand</button><script>let deck=[],hand=[],player=[],cpu=[],discarded=[],used=[],score=0;function s(a){return a.map(_=>Math.floor(Math.random()*52)).sort((x,y)=>x-y).filter((v,i,s)=>i===s.indexOf(v))}function d(){deck=s();hand=[];player=[];cpu=[];discarded=[];used=[];document.getElementById("h").textContent="";document.getElementById("p").textContent="";document.getElementById("b").textContent="";for(let i=0;i<5;i++){hand.push(deck.pop());player.push(deck.pop());cpu.push(deck.pop());}function showHand(a,t){let s="";a.forEach((v,i)=>{let c="CDHS"[(v/13)|0],n=(v%13)+2;s+=`<span style="color:#${["0A2F4B6E8C"][n-2]}">${n>10?n===14?"A":n>9?"J":n>8?"Q":n>7?"K":n>1?n:"A":2:n}</span>${c}</span>`;});t.textContent=s}function deal(){if(hand.length<10){d()}showHand(hand,document.getElementById("h"))}deal()function nd(){document.getElementById("b").textContent="";hand=[];player=[];cpu=[];discarded=[];used=[];d();showHand(hand,document.getElementById("h"))}document.getElementById("n").onclick=nd;function fold(i){if(i>=0&&i<5){discarded.push(hand.splice(i,1)[0]);hand.push(deck.pop());showHand(hand,document.getElementById("h"))}}function flop(){if(discarded.length<3){for(let i=0;i<3-discarded.length;i++){discarded.push(deck.pop());}}function turn(){if(discarded.length<4){discarded.push(deck.pop());}}function river(){if(discarded.length<5){discarded.push(deck.pop());}}function evalHand(a){function c(a){let m={},r=[0,0,0,0,0];a.forEach(v=>{let t=(v%13)+2;r[t-2]++;m[t]=(m[t]||[]).concat(v);});let f=[];for(let i=0;i<5;i++)if(r[i]>1)f.push(i+2);let p=[];for(let i=0;i<5;i++)if(r[i]===1)p.push(i+2);return{f,freq:r,pair:p}}function flush(a){let s=[];a.forEach(v=>s.push((v/13)|0));return s[0]===s[4]}function straight(a){let u=[...new Set(a.map(v=>v-2))].sort((x,y)=>x-y);if(u.length<5)return 0;for(let i=1;i<5;i++)if(u[i]-u[i-1]!==1)return 0;return u[4]+2}function straightflush(a){let f=flush(a);if(!f)return 0;let s=straight(a);return f?s:0}function four(a){let c=evalHand(a).freq;return c.indexOf(4)!==-1}function full(a){let c=evalHand(a).freq;return c.includes(3)&&c.includes(2)}function three(a){let c=evalHand(a).freq;return c.includes(3)}function two(a){let c=evalHand(a).freq;return c.filter(x=>x===2).length===2}function high(a){return evalHand(a).p.sort((x,y)=>y-x)[0]}function rank(a){let h=evalHand(a);if(straightflush(a)===14)return 9;if(four(a))return 8;if(full(a))return 7;if(flush(a))return 6;if(straight(a)===14)return 5;if(h.f.length===4)return 4;if(h.f.length===3&&three(a))return 3;if(h.f.length===2&&two(a))return 2;if(h.f.length===2)return 1;return 0}let ph=rank(player),ch=rank(cpu);document.getElementById("b").textContent="";if(ph>ch){document.getElementById("b").textContent="You win! ðŸŽ‰";score++}else if(ph<ch){document.getElementById("b").textContent="CPU wins! ðŸ˜¢";}else{document.getElementById("b").textContent="Tie! ðŸ¤"}document.getElementById("p").textContent=`Your hand: ${showHand(player,"").replace(/</g,"<span").replace(/>/g,"</span>")}<br>CPU hand: ${showHand(cpu,"").replace(/</g,"<span").replace(/>/g,"</span>")}`;document.getElementById("b").append(`<span>Score: ${score}</span>`)}document.querySelectorAll("body > div").forEach((e,i)=>{if(i===1){e.onclick=e=>{let idx=parseInt(e.target.dataset.i);if(!isNaN(idx)&&idx>=0&&idx<5)fold(idx)}});for(let i=0;i<5;i++)document.getElementById("h").parentNode.appendChild(document.createElement("button")).setAttribute("data.i",i).textContent="Fold "+(i+1)}document.getElementById("b").onclick=()=>{flop();turn();river();evalAndShow()};function evalAndShow(){flop();while(discarded.length<3){discarded.push(deck.pop())};turn();while(discarded.length<4){discarded.push(deck.pop())};river();while(discarded.length<5){discarded.push(deck.pop())};evalHandAndShow()}function evalHandAndShow(){evalAndShow()}document.getElementById("b").onclick=evalAndShow;document.body.appendChild(document.createElement("br"))</script></body></html> [end of text]


