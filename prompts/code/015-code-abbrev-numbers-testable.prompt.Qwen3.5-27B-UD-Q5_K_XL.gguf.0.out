```python
def abbrev_num(x):
    x = int(x)
    if x < 0:
        return "-" + abbrev_num(-x)
    
    if x < 1000:
        return str(x)
    
    units = [
        (1_000_000_000, "B"),
        (1_000_000, "M"),
        (1_000, "K"),
    ]
    
    for threshold, suffix in units:
        if x >= threshold:
            value = x / threshold
            # Try to format with 1 decimal place first
            s = f"{value:.1f}{suffix}"
            # Remove trailing .0 if present
            if s.endswith(".0"):
                s = s[:-2] + suffix
            # Check length constraint
            if len(s) <= 4:
                return s
            # If too long, try rounding to integer
            s = f"{round(value)}{suffix}"
            return s
    
    return str(x)
``` [end of text]


