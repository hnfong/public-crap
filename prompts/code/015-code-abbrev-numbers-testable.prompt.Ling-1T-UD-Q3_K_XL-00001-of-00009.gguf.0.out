def abbrev_num(x):
    if x < 1000:
        return str(x)
    units = ['K', 'M', 'B', 'T']
    magnitude = 0
    temp = x
    while temp >= 1000:
        temp //= 1000
        magnitude += 1
    divisor = 1000 ** magnitude
    value = x / divisor
    if magnitude == 0:
        return str(x)
    if value < 10:
        rounded = round(value, 1)
        s = f"{rounded:.1f}".rstrip('0').rstrip('.')
        if len(s + units[magnitude-1]) <= 4:
            return s + units[magnitude-1]
        else:
            return str(round(value)) + units[magnitude-1]
    else:
        rounded = round(value)
        return str(rounded) + units[magnitude-1] [end of text]


