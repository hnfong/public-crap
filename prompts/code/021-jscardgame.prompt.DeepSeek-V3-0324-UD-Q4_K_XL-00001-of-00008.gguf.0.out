```html
<!DOCTYPE html><html><head><title>Solitaire Twist</title><style>body{font-family:Arial,sans-serif;background:#2c3e50;margin:0;padding:20px;display:flex;justify-content:center;align-items:center;height:100vh;flex-direction:column}canvas{background:#34495e;border-radius:10px;box-shadow:0 0 20px rgba(0,0,0,0.5)}button{background:#3498db;color:white;border:none;padding:10px 20px;margin-top:20px;border-radius:5px;cursor:pointer;font-size:16px}button:hover{background:#2980b9}</style></head><body><h1 style="color:white">Solitaire Twist</h1><canvas id="game" width="800" height="600"></canvas><button id="restart">Restart</button><script>const canvas=document.getElementById('game'),ctx=canvas.getContext('2d'),restartBtn=document.getElementById('restart');let cards=[],selected=null,foundations=[[],[],[],[]],stacks=[[],[],[],[],[],[],[]],dragOffset={x:0,y:0};function init(){cards=[];for(let s=0;s<4;s++)for(let v=1;v<=13;v++)cards.push({suit:s,value:v,faceUp:false});shuffle(cards);stacks=[[],[],[],[],[],[],[]];for(let i=0;i<7;i++)for(let j=0;j<=i;j++){let card=cards.pop();if(j===i)card.faceUp=true;stacks[i].push(card);}foundations=[[],[],[],[]];selected=null;}function shuffle(a){for(let i=a.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[a[i],a[j]]=[a[j],a[i]];}}function draw(){ctx.clearRect(0,0,canvas.width,canvas.height);ctx.fillStyle='#27ae60';for(let i=0;i<4;i++)ctx.fillRect(50+i*110,50,80,120);for(let i=0;i<7;i++)for(let j=0;j<stacks[i].length;j++){let card=stacks[i][j];drawCard(50+i*110,200+j*30,card,card===selected);}for(let i=0;i<4;i++)if(foundations[i].length>0)drawCard(50+i*110,50,foundations[i][foundations[i].length-1],false);}function drawCard(x,y,card,highlight){ctx.fillStyle=highlight?'#f1c40f':card.faceUp?(card.suit<2?'#e74c3c':'#2c3e50'):'#3498db';ctx.fillRect(x,y,80,120);if(card.faceUp){ctx.fillStyle=card.suit<2?'#e74c3c':'#2c3e50';ctx.font='20px Arial';let suit='♥♦♣♠'[card.suit],value='A23456789TJQK'[card.value-1];ctx.fillText(value+' '+suit,x+10,y+30);}}function getCardAt(x,y){for(let i=0;i<7;i++)for(let j=0;j<stacks[i].length;j++){let card=stacks[i][j],cx=50+i*110,cy=200+j*30;if(card.faceUp&&x>=cx&&x<=cx+80&&y>=cy&&y<=cy+120)return{card,stack:i,index:j};}return null;}function canPlace(card,foundationIndex){if(foundations[foundationIndex].length===0)return card.value===1;let top=foundations[foundationIndex][foundations[foundationIndex].length-1];return top.suit===card.suit&&top.value===card.value-1;}function canStack(card,stackIndex){if(stacks[stackIndex].length===0)return card.value===13;let top=stacks[stackIndex][stacks[stackIndex].length-1];return top.faceUp&&(top.suit<2)!==(card.suit<2)&&top.value===card.value+1;}canvas.addEventListener('mousedown',e=>{let rect=canvas.getBoundingClientRect(),x=e.clientX-rect.left,y=e.clientY-rect.top;let cardInfo=getCardAt(x,y);if(cardInfo){selected=cardInfo.card;dragOffset={x:x-(50+cardInfo.stack*110),y:y-(200+cardInfo.index*30);}}else{for(let i=0;i<4;i++)if(x>=50+i*110&&x<=50+i*110+80&&y>=50&&y<=50+120&&foundations[i].length>0){selected=foundations[i][foundations[i].length-1];dragOffset={x:x-(50+i*110),y:y-50};}}});canvas.addEventListener('mousemove',e=>{if(!selected)return;let rect=canvas.getBoundingClientRect(),x=e.clientX-rect.left,y=e.clientY-rect.top;draw();ctx.fillStyle='rgba(255,255,255,0.5)';ctx.fillRect(x-dragOffset.x,y-dragOffset.y,80,120);drawCard(x-dragOffset.x,y-dragOffset.y,selected,true);});canvas.addEventListener('mouseup',e=>{if(!selected)return;let rect=canvas.getBoundingClientRect(),x=e.clientX-rect.left,y=e.clientY-rect.top,placed=false;for(let i=0;i<4&&!placed;i++)if(x>=50+i*110&&x<=50+i*110+80&&y>=50&&y<=50+120&&canPlace(selected,i)){foundations[i].push(selected);removeFromSource(selected);placed=true;}for(let i=0;i<7&&!placed;i++)if(x>=50+i*110&&x<=50+i*110+80&&y>=200&&y<=200+120&&canStack(selected,i)){stacks[i].push(selected);removeFromSource(selected);placed=true;}if(!placed&&selected.faceUp)flipFaceDown(selected);selected=null;draw();});function removeFromSource(card){for(let i=0;i<7;i++)for(let j=0;j<stacks[i].length;j++)if(stacks[i][j]===card){stacks[i].splice(j,1);if(stacks[i].length>0&&!stacks[i][stacks[i].length-1].faceUp)stacks[i][stacks[i].length-1].faceUp=true;return;}for(let i=0;i<4;i++)if(foundations[i].includes(card))foundations[i].pop();}function flipFaceDown(card){for(let i=0;i<7;i++)for(let j=0;j<stacks[i].length;j++)if(stacks[i][j]===card)stacks[i][j].faceUp=false;}restartBtn.addEventListener('click',()=>{init();draw();});init();draw();</script></body></html>
``` [end of text]


